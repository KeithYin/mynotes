# 文件操作

**查看文件和目录**

* tree : 以树的结构列出来目录内部内容
* ls : 只看一级目录

**文件类型(ls -all 输出的第一个的字符)**

* `-`：普通文件
* `d`: 目录
* `l`：软链接
* `b`：块设备
* `c`：字符设备
* `s`：socket 文件
* `p`：管道

**文件目录的增删改**

* `touch filename`: 创建文件
* `rm filename`：删除文件
* `cp `：复制文件
* `mv`：移动文件
* `mkdir dirname`：创建目录

**查看文件内容**

* `head -n ` : 
* `tail -n 10`: 与 `tail -10` 等价
* `cat`
* `more` : 回车一行一行看，空格一页一页看。只能网下看
* `less`：回车一行一行看，空格一页一页看。`ctrl b`往上看



**软链接的创建（创建快捷方式）**

* `ln -s src des` : 软链接，最好使用绝对路径创建软链接
  * 软链接其实只是保存了 文件的路径

**硬链接（像是文件备份，但是没有占用磁盘空间）**

* `ln src des`  ： 硬链接是 直接映射到 inode 上的
  * 对于一个 inode，是记录了硬链接计数的
  * 当 inode 的硬链接计数为0 时，文件就会被删除



**文件目录属性**

* `wc` : `-l` 统计几行，`-c` 统计字符。查看文本文件的
* `od` : 查看二进制文件的，可执行 文件就是 二进制文件
* `du -h` : 查看当前目录下的文件/文件夹占用磁盘大小
* `df -h` : 查看当前磁盘的占用情况 



**文件的查找/检索**

* `find dir  -name "filename"` ：按照**文件名字** 在 **指定目录下** 查找，会递归查找
* `find dir -size +10k` : 按照大小查找，`+10k` 大于10k 的，`-10k` 小于10k 的
  * `find dir -size +10k -size -100M` ： 范围的操作
* `find dir -type d/-/s/p` : 文件类型查找
* `grep -r file_content dir` ： 按文件内容查找，有内容的文件名字打印出来







# linux文件系统

* 文件分块保存在磁盘上
* `inode` ：i节点，保存了一些文件信息（此文件放在哪个块上）



# 目录结构

* /dev : 设备文件所在位置：block 文件（硬盘），管道文件，字符文件（键盘）

# 基本

* `shell` : 命令解析器
  * 作用：看到命令，去系统找对应的程序执行
* `shell` 命令：终端上可以执行的命令






# linux 文件 API

```c++
// 移动文件指针
lseek();

// 文件属性，信息
stat();

// 文件扩展
truncate();

// 创建硬链接
link();
// 软链接
symlink();

readlink(); // 只能读软链接，读出来软链接的路径

// 降低硬链接计数，当计数为0, 当当前程序关闭了文件描述符后，系统会自动删除 inode
// 常用于创建临时文件，有个 defer delete 的功能
unlink()

```



**文件描述符的复制（重定向文件描述符？）**

```c++
// 文件描述符就是 int fd;
int dup(int oldfd); // 返回可用的文件描述符中，最小的文件描述符


/*
 如果 newfd 是打开的，那么 newfd 会先关闭，然后再复制
*/
int dup2(int old, int newfd);

```



**文件属性操作**

```c++
/* 
改变已打开文件的属性
获得/设置异步IO所有权
获得/设置记录锁
*/
int fcntl();
```

